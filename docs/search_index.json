[
["conditions-and-loops.html", "Chapter 10 Conditions and Loops 10.1 if Statements 10.2 for 10.3 while loop 10.4 Toy Example", " Chapter 10 Conditions and Loops When you start to write more sophisticated programs with R, you will very often need to control the flow and order the execution in your code. You will usually run into two types of scenarios: Make the execution of a particular code chunk dependent on a condition Repeat a particular code chunk a certain number of times, which is often referred to as loops. In this Chapter, we will explore these core programming techniques using: if-else statements for and while loops However, in Chapter 11, we will talk about loops more and point you to the idiomatic ways of dealing with loops in R. 10.1 if Statements The main purpose of if is to control precisely which operations are carried out in a given code chunk. A if statement runs a code chunk only if a certain condition is true. This conditional expression allows R to respond differently depending on whether the condition is TRUE or FALSE. The basic template of if is as follows: if(CONDITION IS TRUE){ DO THIS CODE CHUNK 1 } else { DO THIS CODE CHUNK 2 } The condition is palced in the parenthesis after if. The condition must be an expression that returns only a single logical value (TRUE or FALSE). If it is TRUE, the code chunk 1 in the braces will be executed; if the condition is not satisfied, the code chunk 2 in the braces after else will be executed. Let’s create a simple password checker. Imagine that your system password is stored on the server. You can only get into the system if you enter the correct password. For every password you enter, the system gatekeeper will check if your input password matches the one stored on the server. If they don’t match, you will be banned from entry. input &lt;- 113 # assuming that you have the input 113 if(input == 987){ writeLines(&quot;Congratulations! Now you may get in!&quot;) } else{ writeLines(&quot;Sorry! Wrong password.&quot;) } ## Sorry! Wrong password. If they match, you will be allowed to get through. input &lt;- 987 # assuming that you have the input 113 if(input == 987){ writeLines(&quot;Congratulations! Now you may get in!&quot;) } else{ writeLines(&quot;Sorry! Wrong password.&quot;) } ## Congratulations! Now you may get in! Now we can ask R to read the input directly from the user’s input in the R console: input &lt;- readline(prompt=&quot;Please enter your password:&quot;) if(input == 987){ writeLines(&quot;Congratulations! Now you may get in!&quot;) } else{ writeLines(&quot;Sorry! Wrong password.&quot;) } 10.2 for The for loop statment is to repeat a code chunk, often while incrementing an index or counter. The most frequent scenario is to repeat a code chunk through a vector/list, element by element, or through a data frame row by row (or column by column). The basic for loop template is as follows: for(LOOP_INDEX in LOOP_VECTOR){ DO THIS CODE CHUNK } The LOOP_INDEX is a placeholder that represents an element in the LOOP_VECTOR. When the loop begins, the LOOP_INDEX starts off as the first element in the vector. When the loop reaches the end of the brace, the LOOP_INDEX is incremented, taking on the next element in the vector. This process continues until the loop reaches the final element of the LOOP_VECTOR. At this point, the code chunk is executed for the last time, and the loop exits. For example, if we have a character vector with a few words in it. We can use a for loop to get the number of characters for each element in the vector. word_vec &lt;- c(&quot;apple&quot;,&quot;banana&quot;,&quot;watermelon&quot;,&quot;papaya&quot;) for(w in word_vec){ word_nchar &lt;- nchar(w) writeLines(as.character(word_nchar)) } ## 5 ## 6 ## 10 ## 6 For the above example, there is another way to write the for loop: for(i in 1:length(word_vec)){ word_nchar &lt;- nchar(word_vec[i]) writeLines(as.character(word_nchar)) } ## 5 ## 6 ## 10 ## 6 In our first example, the LOOP_INDEX directly represent elements in the LOOP_VECTOR. In our second example, the LOOP_INDEX represents indexes of the vector. 10.3 while loop There is another type of loop. Unlike the for loop, which repeats a code chunk by going through every element in a vector/list/data frame, the while loop repeats a code chunk UNTIL a specific condition evalutes to FALSE. The basic template is as follows: while(LOOP_CONDITION){ DO THIS CODE CHUNK (UNTIL THE LOOP_CONDITION BECOMES FALSE) } Upon the start of a while loop, the LOOP_CONDITION is evaluated. If the condition is TRUE, the braced code chunk is executed line by line till the end of the chunk. At this point, the LOOP_CONDITION will be checked again. The loop terminates immediately when the condition is evaluated to be FALSE. Based on the template above, you should infer that the code chunk executed must somehow cause the loop to exit, and very often will change the value of certain objects, which would eventaully lead to the change of the LOOP_CONDITION. If nothing ever changes the LOOP_CONDITION, R will crash due to the infinite loops. Let’s come back to our password checker. This time let’s create a dumb checker. When you give a wrong password which is smaller than your true answer, it will automatically approach the right asnwer for you (and of course no real-world application would do that!) ans &lt;- 90 guess &lt;- 83 while(guess != ans){ writeLines(&quot;Your `guess` is too small! The system will take care for you!&quot;) guess &lt;- guess + 1 cat(&quot;Now the system is adjusting your `guess` to &quot;, guess, &quot;\\n&quot;) } ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 84 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 85 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 86 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 87 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 88 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 89 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 90 Exercise 10.1 In the above example, if the guess is smaller than ans, our script works fine. However, if the guess is larger than ans, then our script will crash. How to fix it? In other words, you script should produce the following results when guess (83) &lt; ans (90): ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 84 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 85 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 86 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 87 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 88 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 89 ## Your `guess` is too small! The system will take care for you! ## Now the system is adjusting your `guess` to 90 And your script should produce the following results when guess (100) &gt; ans (90): ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 99 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 98 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 97 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 96 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 95 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 94 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 93 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 92 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 91 ## Your `guess` is too large! The system will take care for you! ## Now the system is adjusting your `guess` to 90 10.4 Toy Example Now we are playing the Guess Game. The game is as follows: I pick a number from 1 to 100. You have to guess which number I picked. Every time you guess wrong, I’ll tell you whether the number is higher or lower. We first pack the game as an R function object: guessMyNumber &lt;- function(){ ans &lt;- 18 guess &lt;- readline(prompt = &quot;Please guess my number(0~100):&quot;) guess &lt;- as.numeric(guess) while(guess != ans){ if(guess &lt; ans){ writeLines(&quot;The asnwer is HIGHER.&quot;) guess &lt;- readline(prompt = &quot;Please guess my number(0~100):&quot;) guess &lt;- as.numeric(guess) }else{ writeLines(&quot;The asnwer is LOWER&quot;) guess &lt;- readline(prompt = &quot;Please guess my number(0~100):&quot;) guess &lt;- as.numeric(guess) } } writeLines(&quot;Correct!&quot;) } # endfunc You can play the game by running the function guessMyNumber(): guessMyNumber() Exercise 10.2 (optional) The above guessMyNumber() can be improved. Sometimes naughty users would not input numbers as requested. Instead, they may accidentally (or on purpose) input characters that are NOT numbers in their guesses. How can you adjust the guessMyNumber() so that when users input non-numeric characters, your function would send out a warning message? (See below.) &gt; guessMyNumber_v2() Please guess my number(0~100):12 The asnwer is HIGHER. Please guess my number(0~100):80 The asnwer is LOWER Please guess my number(0~100):1000 The asnwer is LOWER Please guess my number(0~100):a ****Please behave. Input an INTEGER!!!**** Please guess my number(0~100):f ****Please behave. Input an INTEGER!!!**** Please guess my number(0~100):grwf ****Please behave. Input an INTEGER!!!**** Please guess my number(0~100): "]
]
